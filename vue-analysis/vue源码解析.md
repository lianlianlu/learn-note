## ç¬¬é›¶ç«  è¯¾ç¨‹å¤§çº²

- å†…å®¹

<img src="vueæºç è§£æ.assets/01.png" style="zoom:75%;" />

- æŠ€æœ¯æ ˆ
  - vuejs
  - Vue-Router
  - Vuex

- æ ¸å¿ƒ ç¬¬1-4ç« 
  - æ•°æ®é©±åŠ¨
  - ç»„ä»¶åŒ–
  - å“åº”å¼åŸç†

- ç¼–è¯‘   ç¬¬5ç« 
  - parse
  - optimize
  - codegen

- æ‰©å±•  ç¬¬6ç« 
  - event v-model
  - slot  keep-alive
  - transition   transition-group

- ç”Ÿæ€ ç¬¬7-8ç« 
  - Vue-Router
  - Vuex

- ç”µå­ä¹¦

  https://github.com/ustbhuangyi/vue-analysis

---

## ç¬¬ä¸€ç«  å‡†å¤‡å·¥ä½œ

### ç¬¬1èŠ‚ è®¤è¯†Flow

[Flow](https://flow.org/en/docs/getting-started/)æ˜¯facebookå‡ºå“çš„Javascripté™æ€ç±»å‹æ£€æŸ¥å·¥å…·ã€‚ Vuejsçš„æºç åˆ©ç”¨äº†Flowåšäº†é™æ€ç±»å‹æ£€æŸ¥ã€‚

- install    /lesson-code

  ```javascript
  npm install -g flow-bin
  cd flow-test
  flow init       //ç”Ÿæˆ.flowconfig æ–‡ä»¶
  ```

- /lesson-code/flow-code/index.js

  ```javascript
  /*@flow*/   ------ è¯æ˜è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦flowæ£€æŸ¥ã€‚å¦‚æœä¸æ£€æŸ¥ï¼Œå°±å»æ‰è¿™ä¸ª
  ```

-  **ç±»å‹æ¨æ–­**
  flowæ ¹æ®ä»£ç çš„ä¸Šä¸‹æ–‡è¿›è¡Œæ¨æ–­

  ```javascript
  /*@flow*/
  
  function split(str){
    return str.split(' ');
  }
  split(11);
  
  //Terminal
  Error â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ index.js:4:14
  
  Cannot call str.split because property split is missing in Number [1].
  
       1â”‚ /*@flow*/
       2â”‚
       3â”‚ function split(str) {
       4â”‚   return str.split(' ');
       5â”‚ }
       6â”‚
   [1] 7â”‚ split(11);
  
  
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
  æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼ŒåƒğŸ‘‡è¿™ç§ï¼Œå°±ä¸åˆé€‚äº†ã€‚ä¸ä¼šæŠ¥é”™
  //Terminal  -- å…ˆåœæ­¢ä¸Šä¸€ä¸ªï¼Œå†é‡æ–°ç¼–è¯‘ï¼ˆè·¯å¾„é‡Œé¢æœ‰ä¸­æ–‡çš„æ—¶å€™ï¼Œæ— ä¸­æ–‡ç›´æ¥flowå³å¯ï¼‰
  # flow stop
  # flow 
  
  function add(x, y) {
    return x + y;
  }
  add('hellow', 11)
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ 
  No errors!
  ```

- **ç±»å‹æ³¨é‡Š**

  æå‰å†™å¥½æˆ‘ä»¬å¸Œæœ›çš„å˜é‡ç±»å‹ï¼Œä¸è¦flowè‡ªå·±å»çŒœ

  ```javascript
  function add(x:number, y:number):number{
    return x + y;
  }
  add('hello', 11)
  
  Error â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ index.js:6:5
  
  Cannot call add with 'hellow' bound to x because string [1] is incompatible with number [2].
  
   [2] 3â”‚ function add(x : number, y : number) : number{
       4â”‚   return x + y;
       5â”‚ }
   [1] 6â”‚ add('hello', 11)
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
  function add(x:number, y:number):number{
    return x + y;
  }
  add(2, 11)
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ 
  No errors!
    
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
  //æ•°ç»„
  var arr: Array<number> = [1,2,3,4]
  arr.push('hello');
  Error â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ index.js:4:10
  
  Cannot call arr.push because string [1] is incompatible with number [2] in array element.
  
       1â”‚ /*@flow*/
       2â”‚
   [2] 3â”‚ var arr: Array<number> = [1,2,3,4]
   [1] 4â”‚ arr.push('hello');
  
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
  //ç±»
  class Bar {
    x: string;
    y: string | number;
    z: boolean;
  
    constructor(x: string, y: string | number) {
      this.x = x;
      this.y = y;
      this.z = false;
    }
  }
  
  var bar: Bar = new Bar('hello', 4);
  
  var obj: {a: string, b: number, c: Array<string>, d: Bar } = {
    a: 'hello',
    b: 10,
    c: ['h','e','l','l','0'],
    d: new Bar('hi', 3)
  }
  
  No errors!
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
  //ä¿®æ”¹ä¸€ä¸‹
  var bar: Bar = new Bar('hello');  //åªç»™ä¸€ä¸ªå‚æ•°
  Error â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ index.js:15:20
  
  Cannot call Bar because:
   â€¢ Either undefined [1] is incompatible with string [2].
   â€¢ Or undefined [1] is incompatible with number [3].
  
   [2][3]  8â”‚   constructor(x: string, y: string | number) {
           9â”‚     this.x = x;
          10â”‚     this.y = y;
          11â”‚     this.z = false;
          12â”‚   }
          13â”‚ }
          14â”‚
      [1] 15â”‚ var bar: Bar = new Bar('hello');
          16â”‚
          17â”‚ var obj: {a: string, b: number, c: Array<string>, d: Bar } = {
          18â”‚   a: 'hello',
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
  //å†ä¿®æ”¹ä¸€ä¸‹å°±å¥½äº†
  class Bar {
    x: string;
    y: string | number | void;
    z: boolean;
  
    constructor(x: string, y: string | number | void) {
      this.x = x;
      this.y = y;
      this.z = false;
    }
  }
  â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
  //null
  var foo: ?string = null;
  æ­¤æ—¶ fooæ—¢å¯ä»¥æ˜¯stringï¼Œä¹Ÿå¯ä»¥æ˜¯null;
  
  ```

- æ›´å¤šçš„ç±»å‹ï¼Œå¯ä»¥å»https://flow.org/en/docs/types/çœ‹ã€‚

---



### ç¬¬2èŠ‚ vuejsæºç ç›®å½•è®¾è®¡

```javascript
-- src
	-- compiler   #ç¼–è¯‘ç›¸å…³çš„æ–‡ä»¶
  -- core       #å…³äºæ–¹æ³•ï¼Œç»„ä»¶ç›¸å…³çš„  é‡ç‚¹
  -- platforms  #é‡Œé¢æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ web å¹³å°ç›¸å…³ï¼ˆæµè§ˆå™¨ï¼‰ weex è·¨ç«¯
  -- server     #æœåŠ¡ç«¯
  -- sfc        #è§£é‡Šå™¨  å°†.vueæ–‡ä»¶è½¬æ¢æˆå¯¹è±¡
  -- shared     #å…¶ä»–æ–‡ä»¶å¤¹çš„ä¸€äº›å…¬ç”¨æ–¹æ³•
```

- ä½œè€…å°†åŠŸèƒ½æ¨¡å—æ‹†åˆ†çš„éå¸¸æ¸…æ¥šï¼Œç›¸å…³é€»è¾‘éƒ½æ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„ç›®å½•ä¸‹ï¼Œå¹¶æŠŠå¤ç”¨çš„ä»£ç ä¹ŸæŠ½æˆä¸€ä¸ªç‹¬ç«‹çš„ç›®å½•

  è¿™æ ·è®¾è®¡ï¼Œæé«˜ä»£ç çš„é˜…è¯»æ€§å’Œå¯ç»´æŠ¤æ€§

---



### ç¬¬3èŠ‚ vuejs æºç æ„å»º

vuejsæºç æ˜¯åŸºäºRollupæ„å»ºçš„ã€‚Rollupç›¸è¾ƒäºWebpackï¼Œåªå¤„ç†jsï¼Œä¼˜ç‚¹æ˜¯è½»é‡

vueä¹Ÿæ˜¯å‘å¸ƒåˆ°npmä¸Šçš„ï¼Œè€Œæ¯ä¸ªnpmåŒ…éƒ½æ˜¯åœ¨package.jsonæ–‡ä»¶ä¸­ï¼Œå¯¹é¡¹ç›®åšæè¿°

